# Официальный и креативный анализатор базы данных "learning_db"
Этот проект представляет собой набор Python-скриптов для анализа 
данных из учебной базы данных PostgreSQL `learning_db`.

## Структура проекта

Проект использует модульный подход для переиспользования кода.

*   `database.py`: Универсальный модуль для взаимодействия с 
базой данных PostgreSQL. Он содержит функцию `execute_query`, 
которая инкапсулирует логику подключения и выполнения 
SQL-запросов. Все скрипты-анализаторы используют этот модуль 
для получения данных.


## Функциональность

### Табличные отчеты

*   `actor_analyzer.py`: Создает CSV-отчет по самым популярным актерам (по количеству фильмов).
*   `payment_analyzer.py`: Создает CSV-отчет по топ-N клиентам по общей сумме платежей.
*   `rating_film_analyzer.py`: Создает CSV-отчет по топ-N самых длинных фильмов в каждом MPAA-рейтинге.
*   `top_rented_film_analyzer.py`: Создает CSV-отчет по топ-N самых арендуемых фильмов.
*   `profitable_films_analyzer.py`: Создает CSV-отчет по топ-N самых прибыльных фильмов.

### Визуализации

*   `rental_dynamics_plot.py`: Строит и сохраняет **линейный график**, показывающий динамику количества аренд по месяцам.
*   `top_actors_plot.py`: Строит и сохраняет **столбчатую диаграмму** топ-5 самых популярных актеров.
*   `film_length_plot.py`: Строит и сохраняет **скрипичный график** для анализа распределения продолжительности фильмов по рейтингам.

## Как запустить

1.  Клонируйте репозиторий:
    ```bash
    git clone https://github.com/Rad99-max/python-postgres-analyzer.git
    cd python-postgres-analyzer
    ```
2.  Создайте и настройте файл `.env` с вашими данными для 
подключения к БД `learning_db`.

3.  Установите необходимые зависимости:
    ```bash
    pip install -r requirements.txt
    ```
4.  Запустите нужный скрипт, например:
    ```bash
    python actor_analyzer.py --limit 5
    ```
